<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, minimum-scale=1">
    <meta name="msvalidate.01" content="B5163518CBE4A854B63801277FE5E35C" />
    <meta name="google-site-verification" content="ucqagxjVuq0lJZeLKs0F5AppzK111lNt3IoxU6mzlJE" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />

    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WK23PSS');</script>
<!-- Hotjar Tracking Code for staging -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3587741,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<!-- End Hotjar Tracking code -->
    <title>The session API - Neo4j .NET Driver Manual</title>
    <link rel="prev" href="../cypher-workflow/">
    <link rel="next" href="../terminology/">
<link rel="stylesheet" href="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/bundle.css" />
<link rel="stylesheet" href="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/utilities.min.css" />



    <link rel="preload" href="../../../assets/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font">
    <link rel="stylesheet" href="../../../assets/css/site.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="shortcut icon" href="https://neo4j.com/wp-content/themes/neo4jweb/favicon.ico" />


    <meta property="neo:type" content="Docs">
    <meta property="neo:site" content="Reference Docs">


    <meta property="og:site_name" content="Neo4j Graph Data Platform" />
    <meta property="article:publisher" content="https://www.facebook.com/neo4j.graph.database" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="@neo4j" />
    <meta name="twitter:site" content="@neo4j" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="The session API - Neo4j .NET Driver Manual" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:image" content="https://dist.neo4j.com/wp-content/uploads/20210423062553/neo4j-social-share-21.png" />
    <meta property="og:description" content="The session API - Neo4j .NET Driver Manual" />
    <meta property="og:url" content="https://neo4j.com/docs/dotnet-manual/5/session-api/" />
    <link rel="shortcut icon" href="https://neo4j.com/wp-content/themes/neo4jweb/favicon.ico" />
  </head>
  <body class="article docs">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WK23PSS"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script>(function(f,b){if(!b.__SV){var e,g,i,h;window.mixpanel=b;b._i=[];b.init=function(e,f,c){function g(a,d){var b=d.split(".");2==b.length&&(a=a[b[0]],d=b[1]);a[d]=function(){a.push([d].concat(Array.prototype.slice.call(arguments,0)))}}var a=b;"undefined"!==typeof c?a=b[c]=[]:c="mixpanel";a.people=a.people||[];a.toString=function(a){var d="mixpanel";"mixpanel"!==c&&(d+="."+c);a||(d+=" (stub)");return d};a.people.toString=function(){return a.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<i.length;h++)g(a,i[h]);var j="set set_once union unset remove delete".split(" ");a.get_group=function(){function b(c){d[c]=function(){call2_args=arguments;call2=[c].concat(Array.prototype.slice.call(call2_args,0));a.push([e,call2])}}for(var d={},e=["get_group"].concat(Array.prototype.slice.call(arguments,0)),c=0;c<j.length;c++)b(j[c]);return d};b._i.push([e,f,c])};b.__SV=1.2;e=f.createElement("script");e.type="text/javascript";e.async=!0;e.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===f.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";g=f.getElementsByTagName("script")[0];g.parentNode.insertBefore(e,g)}})(document,window.mixpanel||[]);
mixpanel.init("4bfb2414ab973c741b6f067bf06d5575", {batch_requests: true})
mixpanel.track("Page View", {
    pathname: window.location.origin + window.location.pathname,
    search: window.location.search,
    hash: window.location.hash,
    referrer: document.referrer,
})
</script>
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">

      <img class="navbar-logo" src="https://dist.neo4j.com/wp-content/uploads/20230926084108/Logo_FullColor_RGB_TransBG.svg" alt="Neo4j Docs" />
      <a href="/docs/" class="navbar-item no-left-padding" aria-label="Docs">
        Docs
      </a>

      </div>

      <button class="navbar-search search-button" data-target="topbar-nav" id="search_open_mobile" aria-label="Open Search">
        <svg width="23px" height="23px" viewBox="0 0 23 23" version="1.1" class="fill-current float-right" id="searchx" role="button" title="Search Website">
          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"
            stroke-linejoin="round">
            <g transform="translate(-2.000000, -2.000000)" stroke="#a0aec0" stroke-width="1.5">
              <circle
                transform="translate(11.389364, 11.388564) rotate(-23.025000) translate(-11.389364, -11.388564) "
                cx="11.3893642" cy="11.3885639" r="8.056"></circle>
              <path d="M17.0853333,17.0844444 L23.3333333,23.3333333" ></path>
            </g>
          </g>
        </svg>
      </button>
      <button class="navbar-burger" data-target="topbar-nav" aria-label="Mobile Navigation Button">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">


        <div class="navbar-item has-dropdown is-hoverable docs">
          <a class="navbar-link" href="/docs/">Docs</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <span class="project-name">Neo4j DBMS</span>
              <ul class="project-links">
                <li><a href="/docs/getting-started/current/" class="project-link">Getting Started</a></li>
                <li><a href="/docs/operations-manual/current/" class="project-link">Operations</a></li>
                <li><a href="/docs/migration-guide/current/" class="project-link">Migration and Upgrade</a></li>
                <li><a href="/docs/status-codes/current/" class="project-link">Status Codes</a></li>
                <li><a href="/docs/java-reference/current/" class="project-link">Java Reference</a></li>
                <li><a href="/docs/kerberos-add-on/current/" class="project-link">Kerberos Add-on</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <a class="project-name" href="/docs/aura/">Neo4j Aura</a>
              <ul class="project-links">
                <li><a class="project-link" href="/docs/aura">Neo4j Aura</a></li>
                <li><a class="project-link" href="/docs/aura/auradb/">Neo4j AuraDB</a></li>
                <li><a class="project-link" href="/docs/aura/aurads/">Neo4j AuraDS</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Neo4j Tools</span>
              <ul class="project-links">
                <li><a href="/docs/bloom-user-guide/current/" class="project-link">Neo4j Bloom</a></li>
                <li><a href="/docs/browser-manual/current/" class="project-link">Neo4j Browser</a></li>
                <li><a href="/docs/data-importer/current/" class="project-link">Neo4j Data Importer</a></li>
                <li><a href="/docs/desktop-manual/current/" class="project-link">Neo4j Desktop</a></li>
                <li><a href="/docs/ops-manager/current/" class="project-link">Neo4j Ops Manager</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Neo4j Graph Data Science</span>
              <ul class="project-links">
                <li><a href="/docs/graph-data-science/current/" class="project-link">Neo4j Graph Data Science Library</a></li>
                <li><a href="/docs/graph-data-science-client/current/" class="project-link">Neo4j Graph Data Science Client</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Cypher Query Language</span>
              <ul class="project-links">
                <li><a href="/docs/cypher-manual/current/" class="project-link">Cypher</a></li>
                <li><a href="/docs/cypher-cheat-sheet/current/" class="project-link">Cypher Cheat Sheet</a></li>
                <li><a href="/docs/apoc/current/" class="project-link">APOC Library</a></li>
              </ul>
            </div>

           <div class="navbar-item project">
              <span class="project-name" href="/docs/genai">Generative AI</span>
              <ul class="project-links">
                <li><a href="/docs/genai/tutorials/embeddings-vector-indexes/" class="project-link">Embeddings and vector indexes tutorial</a></li>
                <li><a href="/docs/cypher-manual/current/genai-integrations/" class="project-link">GenAI integrations</a></li>
                <li><a href="/docs/cypher-manual/current/indexes/semantic-indexes/vector-indexes/" class="project-link">Vector search indexes</a></li>
              </ul>
            </div>
            
            <div class="navbar-item project">
              <span class="project-name" href="/docs/create-applications">Create applications</span>
              <ul class="project-links">
                <li><a href="/docs/python-manual/current/" class="project-link">Python Driver</a></li>
                <li><a href="/docs/go-manual/current/" class="project-link">Go Driver</a></li>
                <li><a href="/docs/java-manual/current/" class="project-link">Java Driver</a></li>
                <li><a href="/docs/javascript-manual/current/" class="project-link">JavaScript Driver</a></li>
                <li><a href="/docs/dotnet-manual/current/" class="project-link">.Net Driver</a></li>
                <li><a href="/docs/graphql-manual/current/" class="project-link">Neo4j GraphQL Library</a></li>
                <li><a href="/docs/nvl/current/" class="project-link">Neo4j Visualization Library</a></li>
                <li><a href="/docs/ogm-manual/current/" class="project-link">OGM Library</a></li>
                <li><a href="https://docs.spring.io/spring-data/neo4j/docs/current/reference/html/#reference" class="project-link">Spring Data Neo4j</a></li>
                <li><a href="/docs/http-api/current/" class="project-link">HTTP API</a></li>
                <li><a href="/docs/query-api/current/" class="project-link">Neo4j Query API</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name" href="/docs/connectors">Connect data sources</span>
              <ul class="project-links">
                <li><a href="/docs/spark/current/" class="project-link">Neo4j Connector for Apache Spark</a></li>
                <li><a href="/docs/kafka/" class="project-link">Neo4j Connector for Apache Kafka</a></li>
                <li><a href="/docs/cdc/" class="project-link">Change Data Capture (CDC)</a></li>
                <li><a href="/docs/dataflow-bigquery/" class="project-link">BigQuery to Neo4j</a></li>
                <li><a href="/docs/dataflow-google-cloud/" class="project-link">Google Cloud to Neo4j</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable labs">
          <a class="navbar-link" href="/labs/">Labs</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <a class="project-name" href="/labs/genai-ecosystem/">GenAI Ecosystem</a>
              <ul class="project-links">
                <li><a href="/labs/genai-ecosystem/llm-graph-builder/" class="project-link">LLM Knowledge Graph Builder</a></li>
                <li><a href="/labs/genai-ecosystem/vector-search/" class="project-link">Vector Index &amp; Search</a></li>
                <li><a href="/labs/genai-ecosystem/langchain/" class="project-link">LangChain</a></li>
                <li><a href="/labs/genai-ecosystem/langchain-js/" class="project-link">LangChain.js</a></li>
                <li><a href="/labs/genai-ecosystem/llamaindex/" class="project-link">LlamaIndex</a></li>
                <li><a href="/labs/genai-ecosystem/haystack/" class="project-link">Haystack</a></li>
                <li><a href="/labs/genai-ecosystem/dspy/" class="project-link">DSPy</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <strong class="project-name" href="/labs/apoc/">Developer Tools</strong>
              <ul class="project-links">
                <li><a href="/labs/apoc/" class="project-link">APOC Extended</a></li>
                <li><a class="project-link" href="/labs/aura-cli/">Aura CLI</a></li>
                <li><a class="project-link" href="/labs/arrows/">arrows.app</a></li>
                <li><a class="project-link" href="/labs/cypher-workbench/">Cypher Workbench</a></li>
                <li><a class="project-link" href="/labs/etl-tool/">ETL Tool</a></li>
                <li><a class="project-link" href="/labs/neodash/">NeoDash</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <strong class="project-name">Frameworks &amp; Integrations</strong>
              <ul class="project-links">
                <li><a class="project-link" href="/labs/neo4j-needle-starterkit/">Needle Starter Kit</a></li>
                <li><a class="project-link" href="/labs/liquibase/">Neo4j Plugin for Liquibase</a></li>
                <li><a class="project-link" href="/labs/neo4j-migrations/">Neo4j Migrations</a></li>
                <li><a class="project-link" href="/labs/neomodel/">neomodel</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neosemantics/">RDF &amp; Linked Data</a>
              <ul class="project-links">
                <li><a href="/labs/neosemantics/" class="project-link">Neosemantics (Java)</a></li>
                <li><a href="/labs/rdflib-neo4j/" class="project-link">RDFLib-Neo4j (Python)</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
            </div>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable developer">
          <a class="navbar-link" href="/developer/resources/">Get Help</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <a class="project-name" href="https://dev.neo4j.com/forum" target="_blank">Community Forum</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://dev.neo4j.com/chat" target="_blank">Discord Chat</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/developer/kb" target="_blank">Knowledge Base</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://medium.com/neo4j" target="_blank">Neo4j Developer Blog</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://www.youtube.com/neo4j" target="_blank">Neo4j Videos</a>
            </div>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable developer">
          <a class="navbar-link" href="https://graphacademy.neo4j.com/?ref=docs-nav">GraphAcademy</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <a class="project-name" href="https://graphacademy.neo4j.com/categories/beginners/?ref=docs-nav" target="_blank">Beginners Courses</a>
              <ul class="project-links">
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/neo4j-fundamentals/?ref=docs-nav">Neo4j Fundamentals</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/cypher-fundamentals/?ref=docs-nav">Cypher Fundamentals</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/importing-fundamentals/?ref=docs-nav">Importing Data Fundamentals</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/importing-csv-data/?ref=docs-nav">Importing CSV Data</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/modeling-fundamentals/?ref=docs-nav">Graph Data Modeling</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://graphacademy.neo4j.com/categories/data-scientist/?ref=docs-nav" target="_blank">Data Scientist Courses</a>
              <ul class="project-links">
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/gds-product-introduction/?ref=docs-nav">Into to Graph Data Science</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/graph-data-science-fundamentals/?ref=docs-nav">Graph Data Science Fundamentals</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/gds-shortest-paths/?ref=docs-nav">Path Finding</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://graphacademy.neo4j.com/categories/llms/?ref=docs-nav" target="_blank">Generative AI Courses</a>
              <ul class="project-links">
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/llm-fundamentals/?ref=docs-nav">Neo4j &amp; LLM Fundamentals</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/llm-vectors-unstructured//?ref=docs-nav">Vector Indexes &amp; Unstructured Data</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/llm-chatbot-python/?ref=docs-nav">Build a Chatbot with Python</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/llm-chatbot-typescript/?ref=docs-nav">Build a Chatbot with TypeScript</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://graphacademy.neo4j.com/certification/?ref=docs-nav" target="_blank">Neo4j Certification</a>
              <ul class="project-links">
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/neo4j-certification/?ref=docs-nav">Neo4j Certified Professional</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/courses/gds-certification/?ref=docs-nav">Neo4j Graph Data Science Certification</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="navbar-item is-hoverable getting-started-cta">
          <a class="navbar-link primary" href="https://neo4j.com/cloud/platform/aura-graph-database/?ref=docs-nav-get-started">Get Started Free</a>
        </div>
        <div class="navbar-item">
          <a class="navbar-link search-button" href="#search" id="search_open"><svg width="23px" height="23px" viewBox="0 0 23 23"
              version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
              class="fill-current float-right" id="search" role="button" title="Search Website">
              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"
                stroke-linejoin="round">
                <g transform="translate(-2.000000, -2.000000)" stroke="#a0aec0" stroke-width="1.5">
                  <circle
                    transform="translate(11.389364, 11.388564) rotate(-23.025000) translate(-11.389364, -11.388564) "
                    cx="11.3893642" cy="11.3885639" r="8.056"></circle>
                  <path d="M17.0853333,17.0844444 L23.3333333,23.3333333" ></path>
                </g>
              </g>
            </svg><span class="navbar-mobile">Search</span></a>
        </div>
      </div>
    </div>
  </nav>

</header>
<div class="body">
    <a class="show-on-focus skip-link" href="#skip-to-content" title="Skip to content">Skip to content</a>
<div class="nav-container" data-component="dotnet-manual" data-version="5">
  <aside class="nav">
    <div class="panels">
      <div class="component">
  <div class="nav-product">
    <span class="nav-product-name">Neo4j .NET Driver Manual</span>
  </div>
</div>
      





      <div class="nav-panel-menu is-active" data-panel="menu">
    <nav class="nav-menu">
    <ul class="nav-list">
    <li class="nav-item" data-module="ROOT" data-depth="0">
        <ul class="nav-list">
    <li class="nav-item" data-module="ROOT" data-depth="1">
      <a class="nav-link" href="../">The Neo4j .NET Driver Manual v5.23</a>
            </li>
    <li class="nav-item" data-module="ROOT" data-depth="1">
      <a class="nav-link" href="../get-started/">Get started</a>
            </li>
    <li class="nav-item" data-module="ROOT" data-depth="1">
      <a class="nav-link" href="../client-applications/">Client applications</a>
            </li>
    <li class="nav-item" data-module="ROOT" data-depth="1">
      <a class="nav-link" href="../cypher-workflow/">Cypher workflow</a>
            </li>
    <li class="nav-item is-current-page" data-module="ROOT" data-depth="1">
      <a class="nav-link" href="./">The session API</a>
            </li>
    <li class="nav-item" data-module="ROOT" data-depth="1">
      <a class="nav-link" href="../terminology/">Driver terminology</a>
            </li>
</ul>
    </li>
</ul>

  </nav>
</div>
        <div class="feedback" style="height: var(--feedback-height);">
    <div class="header question">
        <p><strong>Is this page helpful?</strong></p>

        <svg width="22px" height="22px" viewBox="0 0 22 22" role="button" class="no" aria-label="No, this page isn't helpful">
            <path
                d="M6.25,15.8333333 C6.25,13.7622655 7.92893219,12.0833333 10,12.0833333 C12.0710678,12.0833333 13.75,13.7622655 13.75,15.8333333"
                ></path>
            <circle  cx="10" cy="10" r="9.58333333"></circle>
            <path
                d="M12.5,4.58333333 C12.8934466,4.05873783 13.5109223,3.75 14.1666667,3.75 C14.822411,3.75 15.4398867,4.05873783 15.8333333,4.58333333"
                ></path>
            <line x1="4.58333333" y1="7.91666667" x2="7.08333333" y2="7.91666667" ></line>
            <path
                d="M7.08333333,8.54166667 C6.96827401,8.54166667 6.875,8.44839266 6.875,8.33333333 C6.875,8.21827401 6.96827401,8.125 7.08333333,8.125 C7.19839266,8.125 7.29166667,8.21827401 7.29166667,8.33333333 C7.29166667,8.44839266 7.19839266,8.54166667 7.08333333,8.54166667"
                ></path>
            <line x1="12.9166667" y1="7.91666667" x2="15.4166667" y2="7.91666667" ></line>
            <path
                d="M15.4166667,8.54166667 C15.3016073,8.54166667 15.2083333,8.44839266 15.2083333,8.33333333 C15.2083333,8.21827401 15.3016073,8.125 15.4166667,8.125 C15.531726,8.125 15.625,8.21827401 15.625,8.33333333 C15.625,8.44839266 15.531726,8.54166667 15.4166667,8.54166667"
                ></path>
            <path
                d="M4.16666667,4.58333333 C4.5601133,4.05873783 5.17758895,3.75 5.83333333,3.75 C6.48907772,3.75 7.10655337,4.05873783 7.5,4.58333333"
                ></path>
        </svg>

        <svg width="22px" height="22px" viewBox="0 0 22 22" role="button" class="yes" aria-label="Yes, this page is helpful">
            <circle  cx="10" cy="10" r="9.58333333"></circle>
            <path
                d="M5.41666667,8.125 C5.53172599,8.125 5.625,8.21827401 5.625,8.33333333 C5.625,8.44839266 5.53172599,8.54166667 5.41666667,8.54166667 C5.30160734,8.54166667 5.20833333,8.44839266 5.20833333,8.33333333 C5.20833333,8.21827401 5.30160734,8.125 5.41666667,8.125"
                ></path>
            <path
                d="M14.5833333,8.125 C14.468274,8.125 14.375,8.21827401 14.375,8.33333333 C14.375,8.44839266 14.468274,8.54166667 14.5833333,8.54166667 C14.6983927,8.54166667 14.7916667,8.44839266 14.7916667,8.33333333 C14.7916667,8.21827401 14.6983927,8.125 14.5833333,8.125"
                ></path>
            <path
                d="M13.2275,12.9166657 C13.4853075,12.9162808 13.7287776,13.035241 13.8869095,13.2388563 C14.0450415,13.4424715 14.1000278,13.7078123 14.0358333,13.9575 C13.562901,15.7999679 11.9021969,17.0882321 10,17.0882321 C8.09780311,17.0882321 6.43709903,15.7999679 5.96416667,13.9575 C5.89997223,13.7078123 5.95495852,13.4424715 6.11309045,13.2388563 C6.27122239,13.035241 6.51469246,12.9162808 6.7725,12.9166657 L13.2275,12.9166657 Z"
                ></path>
        </svg>
    </div>


</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <div class="toolbar-wrapper">
    <button class="nav-toggle" aria-label="Toggle Table of Contents"></button>
    
    

    
    <a href="https://neo4j-driver.qubitpi.org" class="home-link" aria-label="Go to docs home page"></a>
    


    <nav class="breadcrumbs" aria-label="breadcrumbs menu">
  <ul>

    <li><a href="../">Neo4j .NET Driver Manual</a></li>

    <li><a href="./">
        The session API
    </a></li>
  </ul>
</nav>
        <div class="edit-this-page"><a href="https://github.com/QubitPi/neo4j-docs-drivers/tree/HEAD/dotnet-manual/modules/ROOT/pages/session-api.adoc">Edit this Page</a></div>
    </div>
</div>

  
  <div class="content">
    <div id="skip-to-content"></div>
<article class="doc">
<div class="sect-header">
  <h1 class="page">The session API</h1>
</div>





<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>This section details the Session API that is made available by the driver.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dotnet-driver-simple-sessions"><a class="anchor" href="#dotnet-driver-simple-sessions"></a>Simple sessions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Simple sessions provide a "classic" <strong><em>blocking style</em></strong> API for Cypher execution.
In general, simple sessions provide the easiest programming style to work with since API calls are executed in a strictly sequential fashion.</p>
</div>
<div class="sect2">
<h3 id="dotnet-driver-simple-lifecycle"><a class="anchor" href="#dotnet-driver-simple-lifecycle"></a>Lifecycle</h3>
<div class="paragraph">
<p>The session lifetime extends from session construction to session closure.
In languages that support them, simple sessions are usually scoped within a context block; this ensures that they are properly closed and that any underlying connections are released and not leaked.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">using (var session = driver.Session(...)) {
    // transactions go here
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><em>Sessions can be configured in a number of different ways</em></strong>.
This is carried out by supplying configuration inside the session constructor.
See <a href="#dotnet-driver-session-configuration">Session configuration</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-simple-transaction-fn"><a class="anchor" href="#dotnet-driver-simple-transaction-fn"></a>Transaction functions</h3>
<div class="paragraph">
<p>Transaction functions are used for containing transactional units of work.
This form of transaction requires minimal boilerplate code and allows for a clear separation of database queries and application logic.</p>
</div>
<div class="paragraph">
<p>Transaction functions are also desirable since they encapsulate retry logic and allow for the greatest degree of flexibility when swapping out a single instance of server for a cluster.</p>
</div>
<div class="paragraph">
<p>Transaction functions can be called as either read or write operations.
This choice will route the transaction to an appropriate server within a clustered environment.
If you are operating in a single instance environment, this routing has no impact. It does give you flexibility if you choose to adopt a clustered environment later on.</p>
</div>
<div class="paragraph">
<p>Before writing a transaction function <strong><em>it is important to ensure that it is designed to be idempotent</em></strong>.
This is because a function may be executed multiple times if initial runs fail.</p>
</div>
<div class="paragraph">
<p>Any query results obtained within a transaction function should be consumed within that function, as connection-bound resources cannot be managed correctly when out of scope.
To that end, transaction functions can return values but these should be derived values rather than raw results.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong><em>Transaction functions are the recommended form for containing transactional units of work</em></strong>.</p>
</div>
<div class="paragraph">
<p><strong><em>When a transaction fails, the driver retry logic is invoked</em></strong>.
For several failure cases, the transaction can be immediately retried against a different server.
These cases include connection issues, server role changes (e.g. leadership elections) and transient errors.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The methods <code>ExecuteRead</code> and <code>ExecuteWrite</code> have replaced <code>ReadTransaction</code> and <code>WriteTransaction</code>, which are deprecated in version 5.x and will be removed in version 6.0.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public void AddPerson(string name)
{
    using var session = Driver.Session();
    session.ExecuteWrite(tx =&gt; tx.Run("CREATE (a:Person {name: $name})", new { name }).Consume());
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-simple-autocommit-transactions"><a class="anchor" href="#dotnet-driver-simple-autocommit-transactions"></a>Auto-commit transactions (or implicit transactions)</h3>
<div class="paragraph">
<p>An auto-commit transaction, or implicit transaction, is a basic but limited form of transaction.
Such a transaction consists of only one Cypher query and is not automatically retried on failure.
Therefore, any error scenarios will need to be handled by the client application itself.</p>
</div>
<div class="paragraph">
<p>Auto-commit transactions serve the following purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>simple use cases such as when learning Cypher or writing one-off scripts.</p>
</li>
<li>
<p>operations such as batched data load operations, where the driver cannot be aware of the committed state and therefore cannot safely request a retry.
The operator will have to perform a <code>retry</code> or <code>undo</code> under these circumstances.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The driver does not retry auto-commit queries on failure since it is unaware of what state has been committed at the point of failure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unlike other kinds of Cypher query, <code>CALL {} IN TRANSACTIONS</code> queries do not participate in the causal chain.
Therefore, the only way to execute these queries from a driver is to use auto-commit transactions.</p>
</div>
<div class="paragraph">
<p>Please refer to the following for more details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/docs/cypher-manual/5/subqueries/subqueries-in-transactions">Cypher Manual &#8594; <code>CALL</code> subqueries in transactions</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public void AddPerson(string name)
{
    using var session = Driver.Session();
    session.Run("CREATE (a:Person {name: $name})", new { name });
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-simple-result-consume"><a class="anchor" href="#dotnet-driver-simple-result-consume"></a>Consuming results</h3>
<div class="paragraph">
<p>Query results are typically consumed as a stream of records.
The drivers provide a way to iterate through that stream.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public List&lt;string&gt; GetPeople()
{
    using var session = Driver.Session();
    return session.ExecuteRead(
        tx =&gt;
        {
            var result = tx.Run("MATCH (a:Person) RETURN a.name ORDER BY a.name");
            return result.Select(record =&gt; record[0].As&lt;string&gt;()).ToList();
        });
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-simple-result-retain"><a class="anchor" href="#dotnet-driver-simple-result-retain"></a>Retaining results</h3>
<div class="paragraph">
<p>Within a session, <strong><em>only one result stream can be active at any one time</em></strong>.
Therefore, if the result of one query is not fully consumed before another query is executed, the remainder of the first result will be automatically buffered within the result object.</p>
</div>
<div class="imageblock middle">
<div class="content">
<img src="../../../common-content/5/_images/driver-result-buffer.svg" alt="driver result buffer">
</div>
<div class="title">Figure 1. Result buffer</div>
</div>
<div class="paragraph">
<p>This buffer provides a staging point for results, and divides result handling into <strong><em>fetching</em></strong> (moving from the network to the buffer) and <strong><em>consuming</em></strong> (moving from the buffer to the application).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For large results, the result buffer may require a significant amount of memory.</p>
</div>
<div class="paragraph">
<p>For this reason, <strong><em>it is recommended to consume results in order wherever possible</em></strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Client applications can choose to take control of more advanced query patterns by explicitly retaining results.
Such explicit retention may also be useful when a result needs to be saved for future processing.
The drivers offer support for this process, as per the example below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public int AddEmployees(string companyName)
{
    using var session = Driver.Session();
    var persons = session.ExecuteRead(tx =&gt; tx.Run("MATCH (a:Person) RETURN a.name AS name").ToList());
    return persons.Sum(
        person =&gt; session.ExecuteWrite(
            tx =&gt;
            {
                var result = tx.Run(
                    "MATCH (emp:Person {name: $person_name}) " +
                    "MERGE (com:Company {name: $company_name}) " +
                    "MERGE (emp)-[:WORKS_FOR]-&gt;(com)",
                    new { person_name = person["name"].As&lt;string&gt;(), company_name = companyName });

                result.Consume();
                return 1;
            }));
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dotnet-driver-async-sessions"><a class="anchor" href="#dotnet-driver-async-sessions"></a>Asynchronous sessions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Asynchronous sessions provide an API wherein function calls typically return available objects such as futures.
This allows client applications to work within asynchronous frameworks and take advantage of cooperative multitasking.</p>
</div>
<div class="sect2">
<h3 id="dotnet-driver-async-lifecycle"><a class="anchor" href="#dotnet-driver-async-lifecycle"></a>Lifecycle</h3>
<div class="paragraph">
<p>Session lifetime begins with session construction.
A session then exists until it is closed, which is typically set to occur after its contained query results have been consumed.</p>
</div>
<div class="paragraph">
<p>Sessions can be configured in a number of different ways. This is carried out by supplying configuration inside the session constructor.</p>
</div>
<div class="paragraph">
<p>See <a href="#dotnet-driver-session-configuration">Session configuration</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-async-transaction-fn"><a class="anchor" href="#dotnet-driver-async-transaction-fn"></a>Transaction functions</h3>
<div class="paragraph">
<p>Transaction functions are <strong><em>the recommended form for containing transactional units of work</em></strong>.
This form of transaction requires minimal boilerplate code and allows for a clear separation of database queries and application logic.
Transaction functions are also desirable since they encapsulate retry logic and allow for the greatest degree of flexibility when swapping out a single instance of server for a cluster.</p>
</div>
<div class="paragraph">
<p>Functions can be called as either read or write operations.
This choice will route the transaction to an appropriate server within a clustered environment.
If you are in a single instance environment, this routing has no impact but it does give you the flexibility should you choose to later adopt a clustered environment.</p>
</div>
<div class="paragraph">
<p>Before writing a transaction function it is important to ensure that any side-effects carried out by a transaction function should be designed to be idempotent.
This is because a function may be executed multiple times if initial runs fail.</p>
</div>
<div class="paragraph">
<p>Any query results obtained within a transaction function should be consumed within that function, as connection-bound resources cannot be managed correctly when out of scope.
To that end, transaction functions can return values but these should be derived values rather than raw results.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When a transaction fails, the driver retry logic is invoked. For several failure cases, the transaction can be immediately retried against a different server.</p>
</div>
<div class="paragraph">
<p>These cases include connection issues, server role changes (e.g. leadership elections) and transient errors.
Retry logic can be configured when creating a session.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The methods <code>ExecuteReadAsync</code> and <code>ExecuteWriteAsync</code> have replaced <code>ReadTransactionAsync</code> and <code>WriteTransactionAsync</code>, which are deprecated in version 5.x and will be removed in version 6.0.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public async Task&lt;List&lt;string&gt;&gt; PrintAllProducts()
{
    await using var session = Driver.AsyncSession();
    // Wrap whole operation into an managed transaction and
    // get the results back.
    return await session.ExecuteReadAsync(
        async tx =&gt;
        {
            var products = new List&lt;string&gt;();

            // Send cypher query to the database
            var reader = await tx.RunAsync(
                "MATCH (p:Product) WHERE p.id = $id RETURN p.title", // Cypher query
                new { id = 0 } // Parameters in the query, if any
            );

            // Loop through the records asynchronously
            while (await reader.FetchAsync())
                // Each current read in buffer can be reached via Current
            {
                products.Add(reader.Current[0].ToString());
            }

            return products;
        });
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-async-autocommit-transactions"><a class="anchor" href="#dotnet-driver-async-autocommit-transactions"></a>Auto-commit transactions (or implicit transactions)</h3>
<div class="paragraph">
<p>An auto-commit transaction, or implicit transaction, is a basic but limited form of transaction.
Such a transaction consists of only one Cypher query and is not automatically retried on failure.
Therefore, any error scenarios will need to be handled by the client application itself.</p>
</div>
<div class="paragraph">
<p>Auto-commit transactions serve two purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>simple use cases such as when learning Cypher or writing one-off scripts.</p>
</li>
<li>
<p>operations such as batched data load operations, where the driver cannot be aware of the committed state and therefore cannot safely request a retry.
The operator will have to perform a <code>retry</code> or <code>undo</code> under these circumstances.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The driver does not retry auto-commit queries on failure since it is unaware of what state has been committed at the point of failure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unlike other kinds of Cypher Query, <code>CALL {} IN TRANSACTIONS</code> queries do not participate in the causal chain.
Therefore, the only way to execute these queries from a driver is to use auto-commit transactions.</p>
</div>
<div class="paragraph">
<p>Please refer to the following for more details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/docs/cypher-manual/5/clauses/call-subquery#subquery-call-in-transactions">Cypher Manual &#8594; <code>CALL {} IN TRANSACTIONS</code></a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public async Task&lt;List&lt;string&gt;&gt; ReadProductTitles()
{
    var records = new List&lt;string&gt;();
    await using var session = Driver.AsyncSession();

    // Send cypher query to the database.
    // The existing IResult interface implements IEnumerable
    // and does not play well with asynchronous use cases. The replacement
    // IResultCursor interface is returned from the RunAsync
    // family of methods instead and provides async capable methods. 
    var reader = await session.RunAsync(
        "MATCH (p:Product) WHERE p.id = $id RETURN p.title", // Cypher query
        new { id = 0 } // Parameters in the query, if any
    );

    // Loop through the records asynchronously
    while (await reader.FetchAsync())
        // Each current read in buffer can be reached via Current
    {
        records.Add(reader.Current[0].ToString());
    }

    return records;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_combining_transactions"><a class="anchor" href="#_combining_transactions"></a>Combining transactions</h3>
<div class="paragraph">
<p>The driver provides a language idiomatic way to combine multiple transactions within a single asynchronous session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public async Task&lt;int?&gt; EmployEveryoneInCompany(string companyName)
{
    await using var session = Driver.AsyncSession();

    var names = await session.ExecuteReadAsync(
        async tx =&gt;
        {
            var cursor = await tx.RunAsync("MATCH (a:Person) RETURN a.name AS name");
            var people = await cursor.ToListAsync();
            return people.Select(person =&gt; person["name"].As&lt;string&gt;());
        });

    return await session.ExecuteWriteAsync(
        async tx =&gt;
        {
            var relationshipsCreated = new List&lt;int&gt;();
            foreach (var personName in names)
            {
                var cursor = await tx.RunAsync(
                    "MATCH (emp:Person {name: $person_name}) " +
                    "MERGE (com:Company {name: $company_name}) " +
                    "MERGE (emp)-[:WORKS_FOR]-&gt;(com)",
                    new
                    {
                        person_name = personName,
                        company_name = companyName
                    });

                var summary = await cursor.ConsumeAsync();

                relationshipsCreated.Add(summary.Counters.RelationshipsCreated);
            }

            return relationshipsCreated.Sum();
        });
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-async-result-consume"><a class="anchor" href="#dotnet-driver-async-result-consume"></a>Consuming results</h3>
<div class="paragraph">
<p>The asynchronous session API provides language-idiomatic methods to aid integration with asynchronous applications and frameworks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public async Task&lt;List&lt;string&gt;&gt; GetPeopleAsync()
{
    await using var session = Driver.AsyncSession();
    return await session.ExecuteReadAsync(
        async tx =&gt;
        {
            var result = await tx.RunAsync("MATCH (a:Person) RETURN a.name ORDER BY a.name");
            return await result.ToListAsync(r =&gt; r[0].As&lt;string&gt;());
        });
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dotnet-driver-rx-sessions"><a class="anchor" href="#dotnet-driver-rx-sessions"></a>Reactive sessions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Starting with <strong>Neo4j 4.0</strong>, the reactive processing of queries is supported.
This can be achieved through reactive sessions.
Reactive sessions allow for dynamic management of the data that is being exchanged between the driver and the server.</p>
</div>
<div class="paragraph">
<p>Typical of reactive programming, consumers control the rate at which they consume records from queries and the driver in turn manages the rate at which records are requested from the server.
Flow control is supported throughout the entire Neo4j stack, meaning that the query engine responds correctly to the flow control signals.
This results in far more efficient resource handling and ensures that the receiving side is not forced to buffer arbitrary amounts of data.</p>
</div>
<div class="paragraph">
<p>For more information about reactive stream, please see the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.reactivemanifesto.org/">The Reactive Manifesto</a></p>
</li>
<li>
<p><a href="https://www.reactive-streams.org">Reactive Streams for JVM and JavaScript</a></p>
</li>
<li>
<p><a href="https://projectreactor.io/docs/core/release/reference/">Project Reactor reference documentation</a></p>
</li>
<li>
<p><a href="http://introtorx.com/">Introduction to Reactive Extensions to .NET</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Reactive sessions will typically be used in a client application that is already oriented towards the reactive style; it is expected that a reactive dependency or framework is in place.</p>
</div>
<div class="paragraph">
<p>Refer to <a href="../get-started/" class="xref page">Get started</a> for more information on recommended dependencies.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="dotnet-driver-rx-lifecycle"><a class="anchor" href="#dotnet-driver-rx-lifecycle"></a>Lifecycle</h3>
<div class="paragraph">
<p>Session lifetime begins with session construction.
A session then exists until it is closed, which is typically set to occur after its contained query results have been consumed.</p>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-rx-transaction-fn"><a class="anchor" href="#dotnet-driver-rx-transaction-fn"></a>Transaction functions</h3>
<div class="paragraph">
<p>This form of transaction requires minimal boilerplate code and allows for a clear separation of database queries and application logic.
Transaction functions are also desirable since they encapsulate retry logic and allow for the greatest degree of flexibility when swapping out a single instance of server for a cluster.</p>
</div>
<div class="paragraph">
<p>Functions can be called as either read or write operations.
This choice will route the transaction to an appropriate server within a clustered environment.
If you are in a single instance environment, this routing has no impact but it does give you the flexibility should you choose to later adopt a clustered environment.</p>
</div>
<div class="paragraph">
<p>Before writing a transaction function it is important to ensure that any side-effects carried out by a transaction function should be designed to be idempotent.
This is because a function may be executed multiple times if initial runs fail.</p>
</div>
<div class="paragraph">
<p>Any query results obtained within a transaction function should be consumed within that function, as connection-bound resources cannot be managed correctly when out of scope.
To that end, transaction functions can return values but these should be derived values rather than raw results.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When a transaction fails, the driver retry logic is invoked.
For several failure cases, the transaction can be immediately retried against a different server.
These cases include connection issues, server role changes (e.g. leadership elections) and transient errors.
Retry logic can be configured when creating a session.
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The methods <code>ExecuteRead</code> and <code>ExecuteWrite</code> have replaced <code>ReadTransaction</code> and <code>WriteTransaction</code>, which are deprecated in version 5.x and will be removed in version 6.0.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public IObservable&lt;string&gt; PrintAllProducts()
{
    var session = Driver.RxSession();

    return session.ExecuteRead(
            tx =&gt;
            {
                return tx.Run(
                        "MATCH (p:Product) WHERE p.id = $id RETURN p.title", // Cypher query
                        new { id = 0 } // Parameters in the query, if any
                    )
                    .Records()
                    .Select(record =&gt; record[0].ToString());
            })
        .OnErrorResumeNext(session.Close&lt;string&gt;());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sessions can be configured in a number of different ways.
This is carried out by supplying configuration inside the session constructor.
See <a href="#dotnet-driver-session-configuration">Session configuration</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-rx-autocommit-transactions"><a class="anchor" href="#dotnet-driver-rx-autocommit-transactions"></a>Auto-commit transactions (or implicit transactions)</h3>
<div class="paragraph">
<p>An auto-commit transaction, or implicit transaction, is a basic but limited form of transaction.
Such a transaction consists of only one Cypher query and is not automatically retried on failure.
Therefore, any error scenarios will need to be handled by the client application itself.</p>
</div>
<div class="paragraph">
<p>Auto-commit transactions serve two purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>simple use cases such as when learning Cypher or writing one-off scripts.</p>
</li>
<li>
<p>operations such as batched data load operations, where the driver cannot be aware of the committed state and therefore cannot safely request a retry. The operator will have to perform a <code>retry</code> or <code>undo</code> under these circumstances.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The driver does not retry auto-commit queries on failure since it is unaware of what state has been committed at the point of failure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unlike other kinds of Cypher Query, <code>CALL {} IN TRANSACTIONS</code> queries do not participate in the causal chain.
Therefore, the only way to execute these queries from a driver is to use auto-commit transactions.</p>
</div>
<div class="paragraph">
<p>Please refer to the following for more details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/docs/cypher-manual/5/clauses/call-subquery#subquery-call-in-transactions">Cypher Manual &#8594; <code>CALL {} IN TRANSACTIONS</code></a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public IObservable&lt;string&gt; ReadProductTitles()
{
    var session = Driver.RxSession();

    return session.Run(
            "MATCH (p:Product) WHERE p.id = $id RETURN p.title", // Cypher query
            new { id = 0 } // Parameters in the query, if any
        )
        .Records()
        .Select(record =&gt; record[0].ToString())
        .OnErrorResumeNext(session.Close&lt;string&gt;());
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-rx-result-consume"><a class="anchor" href="#dotnet-driver-rx-result-consume"></a>Consuming results</h3>
<div class="paragraph">
<p>To consume data from a query in a reactive session, a subscriber is required to handle the results that are being returned by the publisher.</p>
</div>
<div class="paragraph">
<p>Each transaction corresponds to a data flow which supplies the data from the server.
Result processing begins when records are pulled from this flow.
Only one subscriber may pull data from a given flow.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public IObservable&lt;string&gt; GetPeople()
{
    var session = Driver.RxSession();
    return session.ExecuteRead(
            tx =&gt;
            {
                return tx.Run("MATCH (a:Person) RETURN a.name ORDER BY a.name")
                    .Records()
                    .Select(record =&gt; record[0].As&lt;string&gt;());
            })
        .OnErrorResumeNext(session.Close&lt;string&gt;());
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotnet-driver-rx-cancellation"><a class="anchor" href="#dotnet-driver-rx-cancellation"></a>Cancellation</h3>
<div class="paragraph">
<p>As per the reactive stream specification, a reactive data flow can be cancelled part way through.
This prematurely commits or rolls back the transaction and stops the query engine from producing any more records.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dotnet-driver-session-configuration"><a class="anchor" href="#dotnet-driver-session-configuration"></a>Session configuration</h2>
<div class="sectionbody">
<div class="dlist compact">
<dl>
<dt class="hdlist1">Bookmarks</dt>
<dd>
<p>The mechanism which ensures causal consistency between transactions within a session.
Bookmarks are implicitly passed between transactions within a single session to meet the causal consistency requirements.
There may be scenarios where you might want to use the bookmark from one session in a different new session.</p>
<div class="paragraph">
<p><strong>Default:</strong> None (Sessions will initially be created without a bookmark)</p>
</div>
</dd>
<dt class="hdlist1">Default Access Mode</dt>
<dd>
<p>A fallback for the access mode setting when transaction functions are not used.
Typically, access mode is set per transaction by calling the appropriate transaction function method.
In other cases, this setting is inherited. Note that transaction functions will ignore/override this setting.</p>
<div class="paragraph">
<p><strong>Default:</strong> Write</p>
</div>
</dd>
<dt class="hdlist1">Database</dt>
<dd>
<p>The database with which the session will interact.
When working with a database which is not the default (i.e. the <code>system</code> database or another database in Neo4j 4.0 Enterprise Edition), you can explicitly configure the database which the driver is executing transactions against.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The resolution of database aliases occurs at connection creation time, which is not under the control of the session.
It is therefore not recommended to alter database aliases while there are live sessions.
The per-user home database is resolved at session creation and when first impersonating a user.
Therefore, the creation of a new session is necessary to reflect a changed home database.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="/docs/operations-manual/5/manage-databases/introduction#manage-databases-default">Operations Manual &#8594; The default database</a> for more information on databases.</p>
</div>
<div class="paragraph">
<p>See below and <a href="/docs/cypher-manual/5/access-control/dbms-administration#access-control-dbms-administration-impersonation">Cypher Manual &#8594; The <code>DBMS IMPERSONATE</code> privileges</a> for more information on impersonation.</p>
</div>
<div class="paragraph">
<p><strong>Default:</strong> the default database as configured on the server.</p>
</div>
<div class="paragraph">
<p>See more about <a href="../cypher-workflow/#dotnet-database-selection" class="xref page">Database selection</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>Fetch Size</code></dt>
<dd>
<p>The number of records to fetch in each batch from the server.
Neo4j 4.0 introduces the ability to pull records in batches, allowing the client application to take control of data population and apply back pressure to the server.
This <code>FetchSize</code> applies to <a href="#dotnet-driver-simple-sessions">simple sessions</a> and <a href="#dotnet-driver-async-sessions">async-sessions</a> whereas reactive sessions can be controlled directly using the request method of the subscription.</p>
<div class="paragraph">
<p><strong>Default:</strong> 1000 records</p>
</div>
</dd>
<dt class="hdlist1">Impersonated User</dt>
<dd>
<p>Users can run transactions against the database as different users if they have been granted explicit permission for doing so.
When impersonating a user, the query is run within the complete security context of the impersonated user and not the authenticated user (i.e., home database, permissions, etc.).</p>
<div class="paragraph">
<p>See <a href="/docs/operations-manual/5/manage-databases/introduction#manage-databases-home">Operations Manual &#8594; Per-user home databases</a> for more information on default database per-user.</p>
</div>
<div class="paragraph">
<p><strong>Default:</strong> None (Sessions will be created with the logged user)</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="driver-transaction-configuration"><a class="anchor" href="#driver-transaction-configuration"></a>Transaction configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Additional configuration can be provided to transaction which are executed.</p>
</div>
<div class="sect2">
<h3 id="_transaction_timeout"><a class="anchor" href="#_transaction_timeout"></a>Transaction timeout</h3>
<div class="paragraph">
<p>A timeout value can be provided and transactions which take longer than this value to execute on the server will be terminated.
This value will override the value set by <code>dbms.transaction.timeout</code>.
If no value is provided, the default is taken by the server setting
(see <a href="/docs/operations-manual/5/monitoring/transaction-management">Operations Manual &#8594; Transaction Management</a>).</p>
</div>
<div class="paragraph">
<p>Note: In the context of Neo4j versions 4.2 through 5.2, <code>dbms.transaction.timeout</code> acts as a maximum that the driver cannot override.
For example, with a server setting of <code>dbms.transaction.timeout=10s</code> the driver can specify a shorter timeout (e.g., 5 seconds) but not a value greater than 10 seconds.
If a greater value is supplied the transaction will still timeout after 10 seconds.
In Neo4j 5.3 and later releases, you can set transaction timeout to any value you wish, and it is possible for the driver to override any value set with <code>dbms.transaction.timeout</code>.</p>
</div>
<div class="paragraph">
<p><strong>Default:</strong> Configured on server with <code>dbms.transaction.timeout</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public void AddPerson(string name)
{
    using var session = Driver.Session();
    session.ExecuteWrite(
        tx =&gt; tx.Run("CREATE (a:Person {name: $name})", new { name }).Consume(),
        txConfig =&gt; txConfig.WithTimeout(TimeSpan.FromSeconds(5)));
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_metadata"><a class="anchor" href="#_metadata"></a>Metadata</h3>
<div class="paragraph">
<p>Transactions can be tagged with metadata which will be attached to the executing transaction and visible in various output when listing
transactions and queries as well as appearing in the query log.</p>
</div>
<div class="paragraph">
<p><strong>Default:</strong> None.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public void AddPerson(string name)
{
    using var session = Driver.Session();
    var txMetadata = new Dictionary&lt;string, object&gt; { { "applicationId", "123" } };

    session.ExecuteWrite(
        tx =&gt; tx.Run("CREATE (a:Person {name: $name})", new { name }).Consume(),
        txConfig =&gt; txConfig.WithMetadata(txMetadata));
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination" aria-label="pagination links">
  <span class="prev"><a href="../cypher-workflow/" aria-label="Previous: Cypher workflow">Cypher workflow</a></span>

  <span class="next"><a href="../terminology/" aria-label="Next: Driver terminology">Driver terminology</a></span>
</nav>
</article>
    <aside class="toc sidebar" data-title="Contents"
  data-levels="2">
  <div class="toc-menu">
    <div class="toc-menu-placeholder"></div>

      </div>
  </aside>  </div>
  
</main>
</div>
<footer class="footer">
  <div class="wrapper">

  <div class="column logo">
    <div class="logo-footer"></div>
  </div>
  
  <div class="column links">
    <h2>Learn</h2>
    <ul>
      <li><i class="fa fa-wrench" aria-hidden="true"></i> <a rel="noopener" href="https://neo4j.com/sandbox/?ref=developer-footer">Sandbox</a></li>
      <li><i class="fa fa-comments-o" aria-hidden="true"></i> <a rel="noopener" href="https://community.neo4j.com?ref=developer-footer" target="_blank">Neo4j Community Site</a></li>
      <li><i class="fa fa-book" aria-hidden="true"></i> <a rel="noopener" href="https://medium.com/neo4j" target="_blank">Neo4j Developer Blog</a></li>
      <li><i class="fa fa-youtube" aria-hidden="true"></i> <a rel="noopener" href="https://www.youtube.com/neo4j" target="_blank">Neo4j Videos</a></li>
      <li><i class="fa fa-graduation-cap" aria-hidden="true"></i> <a rel="noopener" href="https://neo4j.com/graphacademy/?ref=developer-footer">GraphAcademy</a></li>
      <li><i class="fa fa-flask" aria-hidden="true"></i> <a href="https://neo4j.com/labs/?ref=developer-footer">Neo4j Labs</a></li>
    </ul>
  </div>
  <div class="column links">
    <h2>Social</h2>
    <ul>
      <li><i class="fa fa-twitter" aria-hidden="true"></i> <a rel="noopener" href="https://twitter.com/neo4j" target="_blank">Twitter</a></li>
      <li><i class="fa fa-meetup" aria-hidden="true"></i> <a rel="noopener" href="https://www.meetup.com/Neo4j-Online-Meetup/" target="_blank">Meetups</a></li>
      <li><i class="fa fa-github" aria-hidden="true"></i> <a rel="noopener" href="https://github.com/neo4j/neo4j" target="_blank">Github</a></li>
      <li><i class="fa fa-stack-overflow" aria-hidden="true"></i> <a rel="noopener" href="https://stackoverflow.com/questions/tagged/neo4j" target="_blank">Stack Overflow</a></li>

      <li class="speaker-program"><a href="https://docs.google.com/forms/d/e/1FAIpQLSdEcNnMruES5iwvOVYovmS1D_P1ZL_HdUOitFrwrvruv5PZvA/viewform">Want to Speak?</a></li>
    </ul>
  </div>
  <div class="column links">
    <h2><a href="https://neo4j.com/contact-us/?ref=footer">Contact Us </a></h2>
    <ul>
      <li>US: 1-855-636-4532</li>
      <li>Sweden +46 171 480 113</li>
      <li>UK: +44 20 3868 3223</li>
      <li>France: +33 (0) 1 88 46 13 20</li>
    </ul>
  </div>

    <div class="column">
    <p> <span id="footer-copyright-year">2024</span> Neo4j, Inc.<br>
      <a href="https://neo4j.com/terms/">Terms</a> | <a href="https://neo4j.com/privacy-policy/">Privacy </a> | <a href="https://neo4j.com/sitemap/">Sitemap</a></p>
    <p>Neo4j<sup></sup>, Neo Technology<sup></sup>, Cypher<sup></sup>, Neo4j<sup></sup> Bloom<sup></sup> and
      Neo4j<sup></sup> Aura<sup></sup> are registered trademarks
      of Neo4j, Inc. All other marks are owned by their respective companies.</p>
  </div>

  
</div>
</footer>

  <script src="../../../assets/js/vendor/auth0.js"></script>
  <script src="../../../assets/js/site.js"></script>
  <script async src="../../../assets/js/vendor/highlight.js"></script>
  <script async src="../../../assets/js/vendor/image-zoom.js"></script>



<div id="neo4j-algolia-search-v2"></div>
<script src="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/bundle.js"></script>
<script src="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/polyfill.js"></script>
<script>window.algoliaSearchOptions = {indexName: "docs",placeholder: "Search Documentation",template: "docs"}</script>
  </body>
</html>
